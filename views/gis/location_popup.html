{{extend 'layout_popup.html'}}
{{include '_popup.html'}}
{{if session.s3.security_policy==1:}}
    <script type="text/javascript">//<![CDATA[
    $(function() {
            // Hide the Admin row for simple security_policy
            $("#gis_location_admin__row").hide();
    });
    //]]></script>
{{else:}}
{{pass}}
<script type="text/javascript">//<![CDATA[
$(function() {
    // If coming from the OR then populate defaults for the fields & Hide unnecessary rows
    if (self.parent.$("input[name='_formname']").val().match("or_office")) {
        var location_name = self.parent.$('#or_office_name').val();
        $("#gis_location_name").val(location_name);
        $("#gis_location_name__row").hide();
        $("#gis_location_description__row").hide();
        $("#gis_location_level__row").hide();
        $("#gis_location_code__row").hide();
        //$("#gis_location_parent__row").hide();
        $("#gis_location_feature_class_id").val(8);
        // Don't hide in case magic number changes! :/
        //$("#gis_location_feature_class_id__row").hide();
        // Use default Marker for Class
        //$("#gis_location_marker_id").val(6);
        $("#gis_location_marker_id__row").hide();
        $("#gis_location_gis_feature_type__row").hide();
        $("#gis_location_wkt__row").hide();
        $("#gis_location_osm_id__row").hide();
    }
});
//]]></script>
<script type="text/javascript">//<![CDATA[
$(function() {
    // If coming from the HMS then populate defaults for the fields & Hide unnecessary rows
    if (self.parent.$("input[name='_formname']").val().match("hms_hospital")) {
        var location_name = self.parent.$('#hms_hospital_name').val();
        $("#gis_location_name").val(location_name);
        $("#gis_location_name__row").hide();
        $("#gis_location_description__row").hide();
        $("#gis_location_level__row").hide();
        $("#gis_location_code__row").hide();
        //$("#gis_location_parent__row").hide();
        $("#gis_location_feature_class_id").val(13);
        // Don't hide in case magic number changes! :/
        //$("#gis_location_feature_class_id__row").hide();
        // Use default Marker for Class
        //$("#gis_location_marker_id").val(7);
        $("#gis_location_marker_id__row").hide();
        $("#gis_location_gis_feature_type__row").hide();
        $("#gis_location_wkt__row").hide();
        $("#gis_location_osm_id__row").hide();
    }
});
//]]></script>
<script type="text/javascript">//<![CDATA[
$(function() {
    // If coming from the Food Requests
    if (self.parent.$("input[name='_formname']").val().match("food_req")) {
        // Hide Fields
        $("#gis_location_marker_id__row").hide();
        $("#gis_location_gis_feature_type__row").hide();
        $("#gis_location_wkt__row").hide();
                
        // Provide tiered Location AutoCompletes
        {{include 'gis/location_autocomplete.js'}}
    }
});
//]]></script>
{{include 'gis/feature_crud.js'}}
{{include 'gis/convert_gps.html'}}