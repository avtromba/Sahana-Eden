{{extend 'layout.html'}}

{{include 'gis/ol_js_loaders.html'}}

<script type="text/javascript">//<![CDATA[

{{include 'gis/ol_start_vars.js'}}

{{include 'gis/ol_layers_all.js'}}

{{include 'gis/ol_vector_registerEvents.js'}}

{{include 'gis/ol_controls_features.js'}}

{{include 'gis/ol_functions.js'}}

Ext.onReady(function() {
    
    map = new OpenLayers.Map('center', options);
	
    addLayers(map);
    
    {{include 'gis/ol_layers_features.js'}}
    
	{{include 'gis/ol_controls.js'}}
    
    var mapPanel = new GeoExt.MapPanel({
        region: "center",
        id: "mappanel",
        xtype: "gx_mappanel",
        map: map,
        center: center,
        zoom: {{=zoom}},
        tbar: new Ext.Toolbar()
    });
    
    {{include 'gis/toolbar.js'}}
    
    var layerList = new GeoExt.tree.LayerContainer({
        text: 'All Layers',
        layerStore: mapPanel.layers,
        leaf: false,
        expanded: true
    });

    var layerTree = new Ext.tree.TreePanel({
        id: "treepanel",
        title: "{{=T("Layers")}}",
        root: layerList,
        enableDD: true
    });
    
    var win = new Ext.Window({
		//title    : 'Sahana Map Viewing Client',
		collapsible: true,
		maximizable: true,
		titleCollapse: true,
		width: {{=width}},
		height: {{=height}},
		layout: 'border',
		items:  [{
                    region: "west",
                    id: "tools",
                    title: "{{=T("Tools")}}",
                    border: true,
                    width: 250,
                    collapsible: true,
                    split: true,
                    items: [ layerTree ]
                },
                mapPanel
                ]
    });

	win.show();
    Ext.QuickTips.init();
    
});

//]]></script>

{{include 'gis/catalogue_toolbar.html'}}

{{include 'gis/ol_status.html'}}

<div id='layerTree'></div>