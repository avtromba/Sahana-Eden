{{extend 'layout.html'}}

<script src="{{=URL(r=request,c='static',f='scripts/gis_layers.js')}}" type="text/javascript" charset="utf-8"></script>
<!--
<script language="javascript">//<![CDATA[
$(function() {
    // When the Keys button is clicked
    $("#keys-btn").click(function() {
        //$(this).hide();
    });
});
//]]></script>
-->

{{try:}}
 {{=H2(title)}}
{{except:}}
{{pass}}
<table>
<tr><td id='btn-panel'>
<a href="{{=URL(r=request,c='gis',f='configs')}}">
<input type="button" id="configs-btn" value="{{=T("Configs")}}" />
</a>
</td><td id='btn-panel'>
<a href="{{=URL(r=request,c='gis',f='features')}}">
<input type="button" id="features-btn" value="{{=T("Features")}}" />
</a>
</td><td id='btn-panel'>
<a href="{{=URL(r=request,c='gis',f='import')}}">
<input type="button" id="import-btn" value="{{=T("Import")}}" />
</a>
</td><td id='btn-panel'>
<a href="{{=URL(r=request,c='gis',f='keys')}}">
<input type="button" id="keys-btn" value="{{=T("Keys")}}" />
</a>
</td><td id='btn-panel'>
<a href="{{=URL(r=request,c='gis',f='markers')}}">
<input type="button" id="markers-btn" value="{{=T("Markers")}}" />
</a>
</td><td id='btn-panel'>
<a href="{{=URL(r=request,c='gis',f='projections')}}">
<input type="button" id="projections-btn" value="{{=T("Projections")}}" />
</a>
</td></tr>
</table>
<p>&nbsp;</p>
<div class='form-container'>
<h3>{{=T("Layers")}}:</h3>
{{try:}}
 {{=layers}}
{{except:}}
{{pass}}
<p>&nbsp;</p>

<strong>{{=T("Add New Layer")}}:</strong>

<div class="label">
<form action="" enctype="multipart/form-data" method="post">
<table>
<tr><td><label>{{=T("Name")}}</label></td>
<td><input name="name" type="text" value="" />
<span class='req'>*</span>
{{if form.errors.name:}}<div class="error">{{=form.errors.name}}</div>{{pass}}</td></tr>
<tr><td><label>{{=T("Description")}}</label></td>
<td><input name="description" type="text" value="" />
{{if form.errors.description:}}<div class="error">{{=form.errors.description}}</div>{{pass}}</td></tr>
<tr><td><label>{{=T("Type")}}</label></td>
<td><select name="type" type="select">
{{for row in options_type:}}
<option
{{if row.name==type:}}
selected="selected"
{{pass}}
value="{{=row.id}}">{{=row.name}}</option>
{{pass}}
</select>
{{if form.errors.type:}}<div class="error">{{=form.errors.type}}</div>{{pass}}</td></tr>
<!-- Subtype field required for OpenStreetMap, Google, VirtualEarth & Yahoo layers -->
<tr id="subtype"><td><label>{{=T("SubType")}}</label></td>
<td><select name="subtype" type="select">
{{for row in options_subtype:}}
<option
{{if row==subtype:}}
selected="selected"
{{pass}}
value="{{=row}}">{{=row}}</option>
{{pass}}
</select>
<!-- FIXME: Allow non-JS browsers to be able to load subtypes list manually -->
<noscript><input type="submit" name="action" value="Load Subtypes" /></noscript>
{{if form.errors.subtype:}}<div class="error">{{=form.errors.subtype}}</div>{{pass}}</td></tr>
<!-- Key field required for Google, Multimap & Yahoo layers -->
<tr id="key"><td><label>{{=T("Key")}}</label></td>
<td><input name="key" type="text" size=108 value="{{=key}}" />
<span class='req'>*</span>
{{if form.errors.key:}}<div class="error">{{=form.errors.key}}</div>{{pass}}</td></tr>
<tr><td><label>{{=T("Enabled")}}</label></td>
<td><input name="enabled" type="checkbox" checked="checked" value="on" /></td></tr>
<tr><td><label>{{=T("Priority")}}</label></td>
<td><select name="priority" type="select">
{{for row in options_priority:}}
<option value="{{=row}}">{{=row}}</option>
{{pass}}
</select>{{if form.errors.priority:}}<div class="error">{{=form.errors.priority}}</div>{{pass}}</td></tr>
<tr><td></td>
<td><input type="submit" value="{{=T("Save")}}" /></td></tr>
</table>
<!-- Gather all errors (some may not be associated with visible fields) -->
{{if form.errors:}}
<div class="error">
{{for error in form.errors:}}
Error in field:
{{=error}}
<br>
Detail:
{{=eval('form.errors.%s' % error)}}
<br>
{{pass}}
</div>
{{pass}}
{{=form.hidden_fields()}}
</form>
</div>
<p><b>Key:</b><b class='red'> * </b> - Fields tagged with a star &#040;<span class='red'> * </span>&#041; are mandatory and must be filled.</p>
<p>&nbsp;</p>
</div>
