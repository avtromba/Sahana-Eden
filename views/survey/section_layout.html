<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>{{try:}}{{=title}}{{except:}}{{pass}}</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
{{if response.refresh:}}{{=XML(response.refresh)}}{{pass}}
{{if session.s3.debug:}}
  <!--{{include 'sahana_styles_debug.html'}}-->
    <!--Running in Debug mode, so we want each script to download separately & to use the uncompressed versions-->

    <!--Web2Py Layer-->
    <script src="/{{=request.application}}/static/scripts/web2py/jquery-1.4.2.js" type="text/javascript"></script>
    <script src="/{{=request.application}}/static/scripts/web2py/calendar.js" type="text/javascript" charset="utf-8"></script>
    <!-- These 2 are included in the 1 above, but so is other stuff :/
    <script src="/{{=request.application}}/static/scripts/web2py/calendar-1.0.js" type="text/javascript" charset="utf-8"></script>
    <script src="/{{=request.application}}/static/scripts/web2py/jquery.clockpick.1.2.4.js" type="text/javascript" charset="utf-8"></script>
    -->
    <script src="/{{=request.application}}/static/scripts/web2py/web2py.js" type="text/javascript" charset="utf-8"></script>
    <!--Scripts which need pre-processing by server must be called in-line-->
    <script type="text/javascript">//<![CDATA[
    jQuery(document).ready(function() {
        jQuery("input[type='checkbox'].delete").click(function() { if(this.checked) if(!confirm("{{=T('Sure you want to delete this object?')}}")) this.checked=false; });
        try { jQuery("input.datetime").focus( function() {Calendar.setup({
             inputField:this.id, ifFormat:"{{=T('%Y-%m-%d %H:%M:%S')}}", showsTime: true,timeFormat: "24"
        }); }); } catch(e) {};
    });
//]]></script>

    <!--T2 Layer-->
    <script src="/{{=request.application}}/static/scripts/T2/fancyzoom.min.js" type="text/javascript" charset="utf-8"></script>
    <!--
    <script src="/{{=request.application}}/static/scripts/T2/rating.js" type="text/javascript" charset="utf-8"></script>
    -->
    <!--Scripts which need pre-processing by server must be called in-line-->
    <script type="text/javascript">//<![CDATA[
    jQuery(document).ready(function(){
        try { jQuery('.zoom').fancyZoom({scaleImg:true, closeOnClick:true, directory:"/{{=request.application}}/static/media"}); } catch(e) {};
    });
//]]></script>

    <!--S3 Layer-->
    <script src="/{{=request.application}}/static/scripts/S3/labels.js" type="text/javascript" charset="utf-8"></script>
    <script src="/{{=request.application}}/static/scripts/S3/jquery.autocomplete.js" type="text/javascript" charset="utf-8"></script>
    <script src="/{{=request.application}}/static/scripts/S3/jquery.cluetip.js" type="text/javascript" charset="utf-8"></script>  
    <script src="/{{=request.application}}/static/scripts/S3/jquery.ui.datepicker.js" type="text/javascript" charset="utf-8"></script>
    <script src="/{{=request.application}}/static/scripts/S3/jquery.validate.js" type="text/javascript" charset="utf-8"></script>
    <script src="/{{=request.application}}/static/scripts/S3/S3.js" type="text/javascript" charset="utf-8"></script>
    <script src="/{{=request.application}}/static/scripts/S3/s3.auto.widget.js" type="text/javascript" charset="utf-8"></script>
    <!--Scripts which need pre-processing by server must be called in-line-->
    <script type="text/javascript">//<![CDATA[

    {{include 'ajaxS3messages.js'}}

    function viewMap(feature_id) {
        var url = '{{=URL(r=request, c='gis', f='display_feature')}}/' + feature_id;
        var iframe = "<iframe width='640' height='480' src='" + url + "'></iframe>";
        $('#map').html(iframe);
    }
    function viewMapMulti(module, resource, instance, jresource) {
        var url = '{{=URL(r=request, c='gis', f='display_features')}}/?module=' + module + '&resource=' + resource + '&instance=' + instance + '&jresource=' + jresource;
        var iframe = "<iframe width='640' height='480' src='" + url + "'></iframe>";
        $('#map').html(iframe);
    }
    jQuery(document).ready(function() {
        jQuery("input.date").datepicker({ changeMonth: true, changeYear: true, dateFormat: 'yy-mm-dd', isRTL: false });
        jQuery('a#delete-btn').click(function(event){ if(confirm("{{=T("Sure you want to delete this object?")}}")) {
                return true;
            } else {
                event.preventDefault();
                return false;
            }
        });
        jQuery('.tooltip').cluetip({activation: 'click', sticky: true, closePosition: 'title',closeText: '<img src="/{{=request.application}}/static/img/cross2.png" alt="close" />',splitTitle: '|'});
        jQuery('.ajaxtip').cluetip({activation: 'click', sticky: true, closePosition: 'title',closeText: '<img src="/{{=request.application}}/static/img/cross2.png" alt="close" />',width: 380});
    });
//]]></script>

{{else:}}
  <!--<link href="/{{=request.application}}/static/styles/S3/sahana.min.css" rel="stylesheet" type="text/css" media="screen" charset="utf-8" />-->
    <!--Running in Production mode, so we want fewer compressed scripts to download-->

    <script src="/{{=request.application}}/static/scripts/web2py/jquery-1.4.2.min.js" type="text/javascript"></script>
    <script src="/{{=request.application}}/static/scripts/S3/jquery.validate.pack.js" type="text/javascript"></script>
    <!-- For Sites Hosted on the Public Internet, using Google's version of jQuery will provide better performance
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js" type="text/javascript"></script>
    -->

    <!--This script is created by /static/scripts/tools/build.sahana.py-->
    <script src="/{{=request.application}}/static/scripts/S3/S3.min.js" type="text/javascript"></script>

    <!--Scripts which need pre-processing by server must be called in-line-->

    <!--Web2Py Layer-->
    <script type="text/javascript">//<![CDATA[
    jQuery(document).ready(function() {
        jQuery("input[type='checkbox'].delete").click(function() { if(this.checked) if(!confirm("{{=T('Sure you want to delete this object?')}}")) this.checked=false; });
        try { jQuery("input.datetime").focus( function() {Calendar.setup({
             inputField:this.id, ifFormat:"{{=T('%Y-%m-%d %H:%M:%S')}}", showsTime: true,timeFormat: "24"
        }); }); } catch(e) {};
    });
//]]></script>

    <!--T2 Layer-->
    <script type="text/javascript">//<![CDATA[

    {{include 'ajaxS3messages.js'}}

    jQuery(document).ready(function(){
        try { jQuery('.zoom').fancyZoom({scaleImg:true, closeOnClick:true, directory:"/{{=request.application}}/static/media"}); } catch(e) {};
    });
//]]></script>

    <!--S3 Layer-->
    <script type="text/javascript">//<![CDATA[
    function viewMap(feature_id) {
        var url = '{{=URL(r=request, c='gis', f='display_feature')}}/' + feature_id;
        var iframe = "<iframe width='640' height='480' src='" + url + "'></iframe>";
        $('#map').html(iframe);
    }
    function viewMapMulti(module, resource, instance, jresource) {
        var url = '{{=URL(r=request, c='gis', f='display_features')}}/?module=' + module + '&resource=' + resource + '&instance=' + instance + '&jresource=' + jresource;
        var iframe = "<iframe width='640' height='480' src='" + url + "'></iframe>";
        $('#map').html(iframe);
    }
    jQuery(document).ready(function() {
        jQuery("input.date").datepicker({ changeMonth: true, changeYear: true, dateFormat: 'yy-mm-dd', isRTL: false });
        jQuery('a#delete-btn').click(function(event){ if(confirm("{{=T("Sure you want to delete this object?")}}")) {
                return true;
            } else {
                event.preventDefault();
                return false;
            }
        });
        jQuery('.tooltip').cluetip({activation: 'click', sticky: true, closePosition: 'title',closeText: '<img src="/{{=request.application}}/static/img/cross2.png" alt="close" />',splitTitle: '|'});
        jQuery('.ajaxtip').cluetip({activation: 'click', sticky: true, closePosition: 'title',closeText: '<img src="/{{=request.application}}/static/img/cross2.png" alt="close" />',width: 380});
    });
//]]></script>

{{pass}}
{{if response.extra_styles:}}{{for sheet in response.extra_styles:}}
  <link href="/{{=request.application}}/static/styles/{{=sheet}}" rel="stylesheet" type="text/css" media="screen" charset="utf-8" />
{{pass}}
{{pass}}
</head>
<body>

<!--
If restricted in session.s3.roles:
Load JavaScript to:
* Go full-screen
* Require Confirmation when leaving a page
* Hide browser buttons, menu & URL bar
-->

<div id="menu_modules">
    {{=MENU2(response.menu, _id='modulenav')}}
</div>

{{if response.menu_options:}}
  <div id="menu_options">
    {{=MENU2(response.menu_options, _id='subnav')}}
  </div>
{{pass}}
{{pass}}

<div class="colmask fullpage">
	<div class="col1">
        <div id="content" class="clearfix">
            {{if response.error:}}<div class="error">{{=response.error}}</div>{{pass}}
            {{if response.warning:}}<div class="warning">{{=response.warning}}</div>{{pass}}
            {{if response.information:}}<div class="information">{{=response.information}}</div>{{pass}}
            {{if response.confirmation:}}<div class="confirmation">{{=response.confirmation}}</div>{{pass}}
            {{if response.flash:}}<div class="confirmation">{{=response.flash}}</div>{{pass}}
            {{include}}
        </div>
	</div>
</div>

<div id="footer">
    {{include "footer.html"}}
</div>

</body>
</html>
